// This file is automatically generated by Keystone, do not modify it manually.
// Modify your Keystone config when you want to change this.

datasource postgresql {
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
  provider          = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                            Int              @id @default(autoincrement())
  name                          String           @default("")
  email                         String           @unique @default("")
  password                      String
  role                          String           @default("contributor")
  isProtected                   Boolean          @default(false)
  createdAt                     DateTime?
  updatedAt                     DateTime?
  createdBy                     User?            @relation("User_createdBy", fields: [createdById], references: [id])
  createdById                   Int?             @map("createdBy")
  updatedBy                     User?            @relation("User_updatedBy", fields: [updatedById], references: [id])
  updatedById                   Int?             @map("updatedBy")
  from_User_createdBy           User[]           @relation("User_createdBy")
  from_User_updatedBy           User[]           @relation("User_updatedBy")
  from_Partner_createdBy        Partner[]        @relation("Partner_createdBy")
  from_Partner_updatedBy        Partner[]        @relation("Partner_updatedBy")
  from_PromotionVideo_createdBy PromotionVideo[] @relation("PromotionVideo_createdBy")
  from_PromotionVideo_updatedBy PromotionVideo[] @relation("PromotionVideo_updatedBy")
  from_EditLog_createdBy        EditLog[]        @relation("EditLog_createdBy")
  from_EditLog_updatedBy        EditLog[]        @relation("EditLog_updatedBy")
  from_Image_createdBy          Image[]          @relation("Image_createdBy")
  from_Image_updatedBy          Image[]          @relation("Image_updatedBy")
  from_Sale_createdBy           Sale[]           @relation("Sale_createdBy")
  from_Sale_updatedBy           Sale[]           @relation("Sale_updatedBy")
  from_Post_createdBy           Post[]           @relation("Post_createdBy")
  from_Post_updatedBy           Post[]           @relation("Post_updatedBy")
  from_Tag_createdBy            Tag[]            @relation("Tag_createdBy")
  from_Tag_updatedBy            Tag[]            @relation("Tag_updatedBy")

  @@index([createdById])
  @@index([updatedById])
}

model Partner {
  id          Int       @id @default(autoincrement())
  slug        String    @unique @default("")
  name        String    @default("")
  website     String    @default("")
  isPublic    Boolean   @default(false)
  createdAt   DateTime?
  updatedAt   DateTime?
  createdBy   User?     @relation("Partner_createdBy", fields: [createdById], references: [id])
  createdById Int?      @map("createdBy")
  updatedBy   User?     @relation("Partner_updatedBy", fields: [updatedById], references: [id])
  updatedById Int?      @map("updatedBy")

  @@index([name])
  @@index([createdById])
  @@index([updatedById])
}

model PromotionVideo {
  id          Int       @id @default(autoincrement())
  name        String    @default("")
  sortOrder   Int?      @unique
  ytUrl       String    @default("")
  state       String?   @default("draft")
  createdAt   DateTime?
  updatedAt   DateTime?
  createdBy   User?     @relation("PromotionVideo_createdBy", fields: [createdById], references: [id])
  createdById Int?      @map("createdBy")
  updatedBy   User?     @relation("PromotionVideo_updatedBy", fields: [updatedById], references: [id])
  updatedById Int?      @map("updatedBy")

  @@index([createdById])
  @@index([updatedById])
}

model EditLog {
  id          Int       @id @default(autoincrement())
  name        String    @default("")
  operation   String    @default("")
  postSlug    String    @default("")
  changedList String    @default("")
  brief       Json?
  content     Json?
  createdAt   DateTime?
  updatedAt   DateTime?
  createdBy   User?     @relation("EditLog_createdBy", fields: [createdById], references: [id])
  createdById Int?      @map("createdBy")
  updatedBy   User?     @relation("EditLog_updatedBy", fields: [updatedById], references: [id])
  updatedById Int?      @map("updatedBy")

  @@index([postSlug])
  @@index([createdById])
  @@index([updatedById])
}

model Image {
  id               Int       @id @default(autoincrement())
  name             String    @default("")
  file_filesize    Int?
  file_filename    String?
  copyright        String?   @default("Copyrighted")
  tags             Tag[]     @relation("Image_tags")
  needWatermark    Boolean   @default(false)
  keywords         String    @default("")
  meta             String    @default("")
  urlOriginal      String    @default("")
  urlDesktopSized  String    @default("")
  urlTabletSized   String    @default("")
  urlMobileSized   String    @default("")
  urlTinySized     String    @default("")
  imageApiData     Json?
  createdAt        DateTime?
  updatedAt        DateTime?
  createdBy        User?     @relation("Image_createdBy", fields: [createdById], references: [id])
  createdById      Int?      @map("createdBy")
  updatedBy        User?     @relation("Image_updatedBy", fields: [updatedById], references: [id])
  updatedById      Int?      @map("updatedBy")
  from_Tag_ogImage Tag[]     @relation("Tag_ogImage")

  @@index([createdById])
  @@index([updatedById])
}

model Sale {
  id          Int            @id @default(autoincrement())
  sortOrder   Int
  adPost      Post?          @relation("Sale_adPost", fields: [adPostId], references: [id])
  adPostId    Int?           @map("adPost")
  state       SaleStateType? @default(draft)
  startTime   DateTime?
  endTime     DateTime?
  createdAt   DateTime?
  updatedAt   DateTime?
  createdBy   User?          @relation("Sale_createdBy", fields: [createdById], references: [id])
  createdById Int?           @map("createdBy")
  updatedBy   User?          @relation("Sale_updatedBy", fields: [updatedById], references: [id])
  updatedById Int?           @map("updatedBy")

  @@index([sortOrder])
  @@index([adPostId])
  @@index([createdById])
  @@index([updatedById])
}

model Post {
  id               Int            @id @default(autoincrement())
  slug             String         @unique @default("")
  name             String         @default("untitled")
  subtitle         String         @default("")
  state            PostStateType? @default(draft)
  publishTime      DateTime?
  createdAt        DateTime?
  updatedAt        DateTime?
  createdBy        User?          @relation("Post_createdBy", fields: [createdById], references: [id])
  createdById      Int?           @map("createdBy")
  updatedBy        User?          @relation("Post_updatedBy", fields: [updatedById], references: [id])
  updatedById      Int?           @map("updatedBy")
  from_Sale_adPost Sale[]         @relation("Sale_adPost")

  @@index([createdById])
  @@index([updatedById])
}

model Tag {
  id              Int       @id @default(autoincrement())
  slug            String    @unique @default("")
  name            String    @unique @default("")
  ogTitle         String    @default("")
  ogDescription   String    @default("")
  ogImage         Image?    @relation("Tag_ogImage", fields: [ogImageId], references: [id])
  ogImageId       Int?      @map("ogImage")
  createdAt       DateTime?
  updatedAt       DateTime?
  createdBy       User?     @relation("Tag_createdBy", fields: [createdById], references: [id])
  createdById     Int?      @map("createdBy")
  updatedBy       User?     @relation("Tag_updatedBy", fields: [updatedById], references: [id])
  updatedById     Int?      @map("updatedBy")
  from_Image_tags Image[]   @relation("Image_tags")

  @@index([ogImageId])
  @@index([createdById])
  @@index([updatedById])
}

enum SaleStateType {
  draft
  published
  scheduled
  archived
}

enum PostStateType {
  draft
  published
  scheduled
  archived
  invisible
}
